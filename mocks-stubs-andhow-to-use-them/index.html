<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
   <link rel="shortcut icon" type="image/ico" href=/images/favicon.ico />
  
  <link href="/assets/css/dist-style.css" rel="stylesheet" />
  <link href="/assets/css/fonts.css" rel="stylesheet" />
  
  <script src="https://unpkg.com/typeit@8.8.4/dist/index.umd.js"></script>
   <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Mocks, Stubs, and how to use them | Srikanth Sastry</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Mocks, Stubs, and how to use them" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Test doubles are the standard mechanism to isolate your System-Under-Test (SUT) from external dependencies in unit tests. Unsurprisingly, it is important to use the right test double for each use case for a maintainable and robust test suite. However, I have seen a lot of misuse of test doubles, and suffered through the consequences of it enough number of times to want to write down some (admittedly subjective) guidelines on when an how to use test doubles." />
<meta property="og:description" content="Test doubles are the standard mechanism to isolate your System-Under-Test (SUT) from external dependencies in unit tests. Unsurprisingly, it is important to use the right test double for each use case for a maintainable and robust test suite. However, I have seen a lot of misuse of test doubles, and suffered through the consequences of it enough number of times to want to write down some (admittedly subjective) guidelines on when an how to use test doubles." />
<link rel="canonical" href="/mocks-stubs-andhow-to-use-them/" />
<meta property="og:url" content="/mocks-stubs-andhow-to-use-them/" />
<meta property="og:site_name" content="Srikanth Sastry" />
<meta property="og:image" content="/images/masquerade-masks.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-05-25T00:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="/images/masquerade-masks.png" />
<meta property="twitter:title" content="Mocks, Stubs, and how to use them" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-05-25T00:00:00+00:00","datePublished":"2022-05-25T00:00:00+00:00","description":"Test doubles are the standard mechanism to isolate your System-Under-Test (SUT) from external dependencies in unit tests. Unsurprisingly, it is important to use the right test double for each use case for a maintainable and robust test suite. However, I have seen a lot of misuse of test doubles, and suffered through the consequences of it enough number of times to want to write down some (admittedly subjective) guidelines on when an how to use test doubles.","headline":"Mocks, Stubs, and how to use them","image":"/images/masquerade-masks.png","mainEntityOfPage":{"@type":"WebPage","@id":"/mocks-stubs-andhow-to-use-them/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/images/site_logo.png"}},"url":"/mocks-stubs-andhow-to-use-them/"}</script>
<!-- End Jekyll SEO tag -->
 
</head>

<body class="bg-white text-gray-900 dark:bg-gray-700 dark:text-slate-100">
  
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      new TypeIt("h1", {}).go();
    });
  </script>
   <nav class="absolute top-0 left-0 right-0 flex w-full flex-wrap items-center justify-between py-4">
  <div class="flex w-full flex-wrap items-center justify-between px-5">
    <a class="flex" href="/" aria-label="Andres Chacon - Developer">
      <img src="/images/site_logo.png" alt="webpage logo" class="block h-8 w-auto">
      <p class="pl-4 hidden md:block text-lg font-bold">Srikanth Sastry <span
          class="text-mulish text-sm font-normal">~/mocks-stubs-andhow-to-use-them/</span>
      </p>
    </a>

    <div class="flex divide-x">
      
      
      
      
      <div><a class="px-4 hover:text-sky-400 "
          href="/archives/">Archives</a></div>
      
      
      
      
      
      <div><a class="px-4 hover:text-sky-400 "
          href="/publications/">Publications</a></div>
      
      
      
      <div><a class="px-4 hover:text-sky-400 "
          href="/touchstone-radio-episodes/">Touchstone Radio Episodes</a></div>
      
      
      
      
      
      
      
      
      
      
      
      
      
      

      
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const currentLangButton = document.querySelector('.current-language');
      const dropdownContent = document.querySelector('.dropdown-content');

      if (currentLangButton && dropdownContent) {
        currentLangButton.addEventListener('click', function () {
          dropdownContent.classList.toggle('hidden');
        });

        document.addEventListener('click', function (event) {
          if (!currentLangButton.contains(event.target) && !dropdownContent.contains(event.target)) {
            dropdownContent.classList.add('hidden');
          }
        });
      }
    });
  </script>
</nav>
 <link rel="stylesheet" href="/assets/css/monokai.css">
<div class="container mx-auto">
  <div id="post" class="prose max-w-[75ch] prose-neutral mx-auto pb-10 pt-20 lg:pt-[90px] lg:pb-20">
    <div class="pb-4">
      <a href="/category/professional"
        class="no-underline font-mulish text-sm hover:text-sky-400 text-gray-500">
        PROFESSIONAL
      </a>
    </div>

    <h1 class="text-left text-2xl font-bold md:text-5xl text-black">Mocks, Stubs, and how to use them</h1>

    <div class="flex flex-col md:flex-row text-sm font-mulish justify-between items-center">
      <div class="flex">
        <p></p>
        <p class="px-2">•</p>
        <p>25 May 2022</p>
        <p class="px-2">•</p>
        <p>
          
           9 mins  </p>
      </div>
      <div>
        <div class="sharing-buttons flex  flex-wrap gap-1 justify-center ">
  <a class="border-2 duration-200 ease inline-flex items-center mb-1 mr-1 transition p-2 rounded-full text-white border-slate-600 bg-slate-600 hover:bg-slate-700 hover:border-slate-700"
    target="_blank" rel="noopener"
    href="https://facebook.com/sharer/sharer.php?u=/mocks-stubs-andhow-to-use-them/"
    aria-label="Share on Facebook">
    <svg aria-hidden="true" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"
      class="w-5 h-5">
      <title>Facebook</title>
      <path
        d="M379 22v75h-44c-36 0-42 17-42 41v54h84l-12 85h-72v217h-88V277h-72v-85h72v-62c0-72 45-112 109-112 31 0 58 3 65 4z">
      </path>
    </svg>
  </a>
  <a class="border-2 duration-200 ease inline-flex items-center mb-1 mr-1 transition p-2 rounded-full text-white border-slate-600 bg-slate-600 hover:bg-slate-700 hover:border-slate-700"
    target="_blank" rel="noopener"
    href="https://twitter.com/intent/tweet?url=/mocks-stubs-andhow-to-use-them/&text=Mocks, Stubs, and how to use them"
    aria-label="Share on Twitter">
    <svg aria-hidden="true" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"
      class="w-5 h-5">
      <title>Twitter</title>
      <path
        d="m459 152 1 13c0 139-106 299-299 299-59 0-115-17-161-47a217 217 0 0 0 156-44c-47-1-85-31-98-72l19 1c10 0 19-1 28-3-48-10-84-52-84-103v-2c14 8 30 13 47 14A105 105 0 0 1 36 67c51 64 129 106 216 110-2-8-2-16-2-24a105 105 0 0 1 181-72c24-4 47-13 67-25-8 24-25 45-46 58 21-3 41-8 60-17-14 21-32 40-53 55z">
      </path>
    </svg>
  </a>
  <a class="border-2 duration-200 ease inline-flex items-center mb-1 mr-1 transition p-2 rounded-full text-white border-slate-600 bg-slate-600 hover:bg-slate-700 hover:border-slate-700"
    target="_blank" rel="noopener"
    href="https://www.linkedin.com/shareArticle?mini=true&url=/mocks-stubs-andhow-to-use-them/&title=Mocks, Stubs, and how to use them&summary=Mocks, Stubs, and how to use them&source="
    aria-label="Share on Linkedin">
    <svg aria-hidden="true" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"
      class="w-5 h-5">
      <title>Linkedin</title>
      <path
        d="M136 183v283H42V183h94zm6-88c1 27-20 49-53 49-32 0-52-22-52-49 0-28 21-49 53-49s52 21 52 49zm333 208v163h-94V314c0-38-13-64-47-64-26 0-42 18-49 35-2 6-3 14-3 23v158h-94V183h94v41c12-20 34-48 85-48 62 0 108 41 108 127z">
      </path>
    </svg>
  </a>
  <a class="border-2 duration-200 ease inline-flex items-center mb-1 mr-1 transition p-2 rounded-full text-white border-slate-600 bg-slate-600 hover:bg-slate-700 hover:border-slate-700"
    target="_blank" rel="noopener"
    href="https://pinterest.com/pin/create/button/?url=/mocks-stubs-andhow-to-use-them/&media=&description=Mocks, Stubs, and how to use them"
    aria-label="Share on Pinterest" draggable="false">
    <svg aria-hidden="true" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"
      class="w-5 h-5">
      <title>Pinterest</title>
      <path
        d="M268 6C165 6 64 75 64 186c0 70 40 110 64 110 9 0 15-28 15-35 0-10-24-30-24-68 0-81 62-138 141-138 68 0 118 39 118 110 0 53-21 153-90 153-25 0-46-18-46-44 0-38 26-74 26-113 0-67-94-55-94 25 0 17 2 36 10 51-14 60-42 148-42 209 0 19 3 38 4 57 4 3 2 3 7 1 51-69 49-82 72-173 12 24 44 36 69 36 106 0 154-103 154-196C448 71 362 6 268 6z">
      </path>
    </svg>
  </a>
  <a class="border-2 duration-200 ease inline-flex items-center mb-1 mr-1 transition p-2 rounded-full text-white border-slate-600 bg-slate-600 hover:bg-slate-700 hover:border-slate-700"
    target="_blank" rel="noopener"
    href="https://reddit.com/submit/?url=/mocks-stubs-andhow-to-use-them/&resubmit=true&title=Mocks, Stubs, and how to use them"
    aria-label="Share on Reddit" draggable="false">
    <svg aria-hidden="true" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"
      class="w-5 h-5">
      <title>Reddit</title>
      <path
        d="M440 204c-15 0-28 6-38 15-35-24-83-40-137-42l28-125 88 20c0 22 18 39 39 39 22 0 40-18 40-39s-17-40-40-40c-15 0-28 9-35 22l-97-22c-5-1-10 3-11 7l-31 138c-53 2-100 18-136 43a53 53 0 0 0-38-16c-56 0-74 74-23 100l-3 24c0 84 95 152 210 152 117 0 211-68 211-152 0-8-1-17-3-25 50-25 32-99-24-99zM129 309a40 40 0 1 1 80 0 40 40 0 0 1-80 0zm215 93c-37 37-139 37-176 0-4-3-4-9 0-13s10-4 13 0c28 28 120 29 149 0 4-4 10-4 14 0s4 10 0 13zm-1-54c-22 0-39-17-39-39a39 39 0 1 1 39 39z">
      </path>
    </svg>
  </a>
  <a class="border-2 duration-200 ease inline-flex items-center mb-1 mr-1 transition p-2 rounded-full text-white border-slate-600 bg-slate-600 hover:bg-slate-700 hover:border-slate-700"
    target="_blank" rel="noopener"
    href="https://wa.me/?text=Mocks,%20Stubs,%20and%20how%20to%20use%20them%20"
    aria-label="Share on Whatsapp" draggable="false">
    <svg aria-hidden="true" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"
      class="w-5 h-5">
      <title>Whatsapp</title>
      <path
        d="M413 97A222 222 0 0 0 64 365L31 480l118-31a224 224 0 0 0 330-195c0-59-25-115-67-157zM256 439c-33 0-66-9-94-26l-7-4-70 18 19-68-4-7a185 185 0 0 1 287-229c34 36 56 82 55 131 1 102-84 185-186 185zm101-138c-5-3-33-17-38-18-5-2-9-3-12 2l-18 22c-3 4-6 4-12 2-32-17-54-30-75-66-6-10 5-10 16-31 2-4 1-7-1-10l-17-41c-4-10-9-9-12-9h-11c-4 0-9 1-15 7-5 5-19 19-19 46s20 54 23 57c2 4 39 60 94 84 36 15 49 17 67 14 11-2 33-14 37-27s5-24 4-26c-2-2-5-4-11-6z">
      </path>
    </svg>
  </a>
  <a class="border-2 duration-200 ease inline-flex items-center mb-1 mr-1 transition p-2 rounded-full text-white border-slate-600 bg-slate-600 hover:bg-slate-700 hover:border-slate-700"
    target="_blank" rel="noopener"
    href="https://telegram.me/share/url?text=Mocks,%20Stubs,%20and%20how%20to%20use%20them&url=/mocks-stubs-andhow-to-use-them/"
    aria-label="Share on Telegram" draggable="false">
    <svg aria-hidden="true" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"
      class="w-5 h-5">
      <title>Telegram</title>
      <path
        d="M256 8a248 248 0 1 0 0 496 248 248 0 0 0 0-496zm115 169c-4 39-20 134-28 178-4 19-10 25-17 25-14 2-25-9-39-18l-56-37c-24-17-8-25 6-40 3-4 67-61 68-67l-1-4-5-1q-4 1-105 70-15 10-27 9c-9 0-26-5-38-9-16-5-28-7-27-16q1-7 18-14l145-62c69-29 83-34 92-34 2 0 7 1 10 3l4 7a43 43 0 0 1 0 10z">
      </path>
    </svg>
  </a>
  <a class="border-2 duration-200 ease inline-flex items-center mb-1 mr-1 transition p-2 rounded-full text-white border-slate-600 bg-slate-600 hover:bg-slate-700 hover:border-slate-700"
    target="_blank" rel="noopener"
    href="mailto:?subject=Mocks,%20Stubs,%20and%20how%20to%20use%20them&body=/mocks-stubs-andhow-to-use-them/"
    aria-label="Share by Email" draggable="false">
    <svg aria-hidden="true" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"
      class="w-5 h-5">
      <title>Email</title>
      <path
        d="M464 64a48 48 0 0 1 29 86L275 314c-11 8-27 8-38 0L19 150a48 48 0 0 1 29-86h416zM218 339c22 17 54 17 76 0l218-163v208c0 35-29 64-64 64H64c-35 0-64-29-64-64V176l218 163z">
      </path>
    </svg>
  </a>
</div>

      </div>
    </div>

    <img class="w-full" src="/images/masquerade-masks.png" alt="Mocks, Stubs, and how to use them">

    <div class="my-6">
      <!-- ![Photo by Polina Kovaleva from Pexels](/images/masquerade-masks.png) -->
<p><em>Photo by <a href="https://www.pexels.com/@polina-kovaleva?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels">Polina Kovaleva</a> from <a href="https://www.pexels.com/photo/close-up-of-masquerade-masks-on-purple-background-8404608/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels">Pexels</a></em></p>

<p><a href="https://en.wikipedia.org/wiki/Test_double">Test doubles</a> are the standard mechanism to isolate your System-Under-Test (SUT) from external dependencies in unit tests. Unsurprisingly, it is important to use the right test double for each use case for a maintainable and robust test suite. However, I have seen a lot of misuse of test doubles, and suffered through the consequences of it enough number of times to want to write down some (admittedly subjective) guidelines on when an how to use test doubles.</p>

<p>Briefly, test doubles are <a href="https://martinfowler.com/bliki/TestDouble.html">replacements for a production object used for testing</a>. Depending on who you ask, there are multiple different categorizations of test doubles; but two categories that appears in all of these categorizations are <a href="https://en.wikipedia.org/wiki/Mock_object">mocks</a> and <a href="https://en.wikipedia.org/wiki/Test_stub">stubs</a>. So I will focus on on these two. I have seen mocks and stubs often conflated together. The problem is made worse by all the test-double frameworks’ terminology: they are often referred to as ‘mocking’ frameworks, and the test doubles they generate are all called ‘mocks’.</p>

<h2 id="mocks">Mocks</h2>

<p><img src="/images/woman-wearing-emoji-mask.jpg" alt="woman wearing an emoji mask" /></p>

<p><em>Image by <a href="https://pixabay.com/users/5697702-5697702/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=2428737">Andii Samperio</a> from <a href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=2428737">Pixabay</a></em></p>

<p>Mocks are objects that are used to verify ‘outbound’ interactions of the SUT with external dependencies. This is different from the notion of ‘mocks’ that ‘mocking frameworks’ generate. Those ‘mocks’ are more correctly the superclass of test doubles.
Examples where mocks are useful include the SUT logging to a log server, or sending an email, or filing a task/ticket in response to a given input/user journey. This becomes clearer with an illustration.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">unittest.mock</span> <span class="kn">import</span> <span class="n">MagicMock</span>

<span class="k">class</span> <span class="nc">TestSUT</span><span class="p">(</span><span class="n">unittest</span><span class="p">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">test_log_success</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">mock_log_server</span> <span class="o">=</span> <span class="n">MagicMock</span><span class="p">(</span><span class="n">spec</span><span class="o">=</span><span class="n">LogServerClass</span><span class="p">,</span> <span class="n">autospec</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">mock_log_server</span><span class="p">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">MagicMock</span><span class="p">(</span><span class="n">return_value</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">sut</span> <span class="o">=</span> <span class="n">SUT</span><span class="p">(</span><span class="n">log_server</span><span class="o">=</span><span class="n">mock_log_server</span><span class="p">)</span>
        
        <span class="n">sut</span><span class="p">.</span><span class="n">test_method</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="s">"foo"</span><span class="p">)</span>
        
        <span class="c1"># This is ok!
</span>        <span class="n">mock_log_server</span><span class="p">.</span><span class="n">log</span><span class="p">.</span><span class="n">assert_called_once_with</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s">"foo"</span><span class="p">)</span>

</code></pre></div></div>

<p>Note that in the above illustration, we verify that the message is sent to the the log server exactly once. This is an important part of the SUT’s specification. It the SUT were to start logging multiple messages/records for the request, then it could pollute the logs or even overwhelm the log server. Here, even though logging appears to be a side effect of <code class="language-plaintext highlighter-rouge">test_method</code>, this side effect is almost certainly part of SUT’s specification, and needs to be verified correctly. Mocks play a central role in such verifications.</p>

<h2 id="stubs">Stubs</h2>

<p><img src="/images/robot-imitating-family.jpg" alt="Robot imitating family" /></p>

<p>Unlike mocks, stubs verify ‘inbound’ interactions from external dependencies to the SUT. Stubs are useful when replacing external dependencies that ‘send’ data to the SUT in order for the SUT to satisfy its specification. Examples include key value stores, databases, event listeners, etc. The important note here is that the outbound interaction to the stub <em>should not be asserted</em> in the tests; that’s an anti pattern (it results in over-specification)! Here is an illustration.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">unittest.mock</span> <span class="kn">import</span> <span class="n">MagicMock</span>

<span class="k">class</span> <span class="nc">TestSUT</span><span class="p">(</span><span class="n">unittest</span><span class="p">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">test_email_retrieval</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">stub_key_value_store</span> <span class="o">=</span> <span class="n">MagicMock</span><span class="p">(</span><span class="n">spec</span><span class="o">=</span><span class="n">KeyValueStoreClass</span><span class="p">,</span> <span class="n">autospec</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">stub_key_value_store</span><span class="p">.</span><span class="n">get</span> <span class="o">=</span> <span class="n">MagicMock</span><span class="p">(</span><span class="n">return_value</span><span class="o">=</span><span class="s">"user@special_domain.com"</span><span class="p">)</span>
        <span class="n">sut</span> <span class="o">=</span> <span class="n">SUT</span><span class="p">(</span><span class="n">key_value_store</span><span class="o">=</span><span class="n">stub_key_value_store</span><span class="p">)</span>
        
        <span class="n">email_domain</span> <span class="o">=</span> <span class="n">sut</span><span class="p">.</span><span class="n">get_user_email_domin</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s">"foo"</span><span class="p">)</span>
        
        <span class="c1"># This is ok!
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">assertEquals</span><span class="p">(</span><span class="s">"special_domain.com"</span><span class="p">,</span> <span class="n">email_domain</span><span class="p">)</span>
        
        <span class="c1"># THIS IS NOT OK!
</span>        <span class="n">stub_key_value_store</span><span class="p">.</span><span class="n">get</span><span class="p">.</span><span class="n">assert_called_once_with</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s">"foo"</span><span class="p">)</span>

</code></pre></div></div>
<p>In the above illustration, we create a stub for the key value store (note that this is a stub even thought the object is a ‘mock’ class) that returns <code class="language-plaintext highlighter-rouge">"user@special_domain.com"</code> as a canned response to a <code class="language-plaintext highlighter-rouge">get</code> call. The test verifies that the SUT’s <code class="language-plaintext highlighter-rouge">get_user_email_domain</code> is called, it returns the correct email domain. What is important here is that we <em>should not</em> assert that there was a <code class="language-plaintext highlighter-rouge">get</code> call to the stub. Why? Because the call to the key value store is an implementation detail. Imagine a refactor that causes a previous value to be cached locally. If the unit tests were to assert on calls to the stubs, then such refactors would result in unit test failures, which undermines the utility, maintainability, and robustness of unit tests.</p>

<h3 id="fakes-instead-of-stubs">Fakes, instead of stubs</h3>

<p>A small detour here. When using a stub, always consider if you can use a fake instead. There are multiple definitions of a fake, and the one I am referring to is the following. A fake is a special kind of stub that implements the same API as the production dependency, but the implementation is much more lightweight. This implementation may be correct only within the context of the unit tests where it is used. Let’s reuse the previous illustration of using a stub, and replace the stub with a fake. Recall that we stubbed out the <code class="language-plaintext highlighter-rouge">get</code> method of <code class="language-plaintext highlighter-rouge">KeyValueStoreClass</code> to return the canned value <code class="language-plaintext highlighter-rouge">"user@special_domain.com"</code>. Instead, we can implement a fake <code class="language-plaintext highlighter-rouge">KeyValueStoreClass</code> that uses a <code class="language-plaintext highlighter-rouge">Dict</code> as follows.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">unittest.mock</span> <span class="kn">import</span> <span class="n">MagicMock</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span>

<span class="c1"># We assume a simplistic API for KeyValueStoreClass with just
# update and get methods.
</span><span class="k">class</span> <span class="nc">KeyValueStoreClass</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="p">...</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="p">...</span>

<span class="k">class</span> <span class="nc">FakeKeyValueStoreClassImpl</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">kvs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span><span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">kvs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>

    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">kvs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>


<span class="k">class</span> <span class="nc">TestSUT</span><span class="p">(</span><span class="n">unittest</span><span class="p">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">test_email_retrieval</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">FakeKeyValueStoreClass</span> <span class="o">=</span> <span class="n">MagicMock</span><span class="p">(</span><span class="n">return_value</span><span class="o">=</span><span class="n">FakeKeyValueStoreClassImpl</span><span class="p">())</span>
        <span class="n">fake_key_value_store</span> <span class="o">=</span> <span class="n">FakeKeyValueStoreClass</span><span class="p">()</span>
        <span class="n">fake_key_value_store</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="s">"foo"</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="s">"user@special_domain.com"</span><span class="p">)</span>
        <span class="n">sut</span> <span class="o">=</span> <span class="n">SUT</span><span class="p">(</span><span class="n">key_value_store</span><span class="o">=</span><span class="n">fake_key_value_store</span><span class="p">)</span>
        
        <span class="n">email_domain</span> <span class="o">=</span> <span class="n">sut</span><span class="p">.</span><span class="n">get_user_email_domin</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s">"foo"</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="p">.</span><span class="n">assertEquals</span><span class="p">(</span><span class="s">"special_domain.com"</span><span class="p">,</span> <span class="n">email_domain</span><span class="p">)</span>
</code></pre></div></div>

<p>The advantage of using a fake is that the test becomes much more robust and is more resistant to refactoring. It also becomes more extensible. When using a stub, if we wanted to test a different user journey, we would need to inject a new return value for <code class="language-plaintext highlighter-rouge">KeyValueStoreClass.get</code> method. We would in one of two ways:  (1) resetting the mock, which is a bad anti-pattern, or (2) initialize the stub to return a preconfigured list of canned values, in order, which makes the test more brittle (consider what happens if the SUT chooses to call <code class="language-plaintext highlighter-rouge">get</code> for the same key twice vs. calls <code class="language-plaintext highlighter-rouge">get</code> for different keys once each). Using a fake sidesteps these issues.</p>

<h2 id="but-my-dependency-has-both-inbound-and-outbound-interactions">But my dependency has both inbound and outbound interactions!</h2>

<p><img src="/images/man-double-exposed-photo.jpg" alt="Photograph of man double exposure" /></p>

<p>Despite all your efforts to separate out the test cases that need stubs and the ones that need mocks, you will inevitably find yourself needing to test a scenario in which you need to verify both inbound and outbound interactions with an external dependency. How do we address that?</p>

<p>First, if you need to assert on the outbound interaction of the same call that is stubbed, then you really don’t need that test. Just use a stub/fake and do not assert on the outbound interaction. Next, the only legitimate case of needing to verify both inbound and outbound interactions is if they are on distinct APIs of the same dependency. For example, the SUT could be reading from a file, and you need to test that (1) the contents of the file were read correctly, and (2) the file object was closed after the file was read. In this case, it is perfectly ok to stub the file <code class="language-plaintext highlighter-rouge">read</code> method while mocking the <code class="language-plaintext highlighter-rouge">close</code> method. Here is an illustration.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">unittest.mock</span> <span class="kn">import</span> <span class="n">MagicMock</span><span class="p">,</span> <span class="n">patch</span>

<span class="k">class</span> <span class="nc">TestSUT</span><span class="p">(</span><span class="n">unittest</span><span class="p">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">test_file_read</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">file_mock_stub_combo</span> <span class="o">=</span> <span class="n">MagicMock</span><span class="p">()</span>
        <span class="c1"># Using this as a stub by injecting canned contents of the file
</span>        <span class="n">file_mock_stub_combo</span><span class="p">.</span><span class="n">__iter__</span><span class="p">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="p">[</span><span class="s">"1234"</span><span class="p">]</span>
        
        <span class="c1"># Next, we treat the file open call as a mock.
</span>        <span class="k">with</span> <span class="n">patch</span><span class="p">(</span><span class="s">"builtins.open"</span><span class="p">,</span>
                   <span class="n">return_value</span><span class="o">=</span><span class="n">file_mock_stub_combo</span><span class="p">,</span> 
                   <span class="n">create</span><span class="o">=</span><span class="bp">True</span>
                  <span class="p">)</span> <span class="k">as</span> <span class="n">mock_file</span><span class="p">:</span>
            <span class="n">sut</span> <span class="o">=</span> <span class="n">SUT</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s">"foo"</span><span class="p">)</span>
            <span class="n">file_contents</span> <span class="o">=</span> <span class="n">sut</span><span class="p">.</span><span class="n">get_contents</span><span class="p">()</span>
            
            <span class="c1"># Assertions on call to file open.
</span>            <span class="c1"># Treating the 'open' call as a mock.
</span>            <span class="n">mock_file</span><span class="p">.</span><span class="n">assert_called_once_with</span><span class="p">(</span><span class="s">"foo"</span><span class="p">)</span>
        
            <span class="c1"># Assertion on the contents returned.
</span>            <span class="c1"># Treating the `read` as a stub.
</span>            <span class="bp">self</span><span class="p">.</span><span class="n">assertEquals</span><span class="p">(</span><span class="s">"1234"</span><span class="p">,</span> <span class="n">file_contents</span><span class="p">)</span>
        
            <span class="c1"># Assertion on the outbound interaction of file close.
</span>            <span class="c1"># Treating the 'close' call as a mock.
</span>            <span class="n">file_mock_stub_combo</span><span class="p">.</span><span class="n">close</span><span class="p">.</span><span class="n">assert_called_once</span><span class="p">()</span>
</code></pre></div></div>


    </div>

    <div class="mx-auto py-8">
      <p class="text-center font-extrabold italic">
        Like it? Share it!
      </p>
      <div class="sharing-buttons flex  flex-wrap gap-1 justify-center ">
  <a class="border-2 duration-200 ease inline-flex items-center mb-1 mr-1 transition p-2 rounded-full text-white border-slate-600 bg-slate-600 hover:bg-slate-700 hover:border-slate-700"
    target="_blank" rel="noopener"
    href="https://facebook.com/sharer/sharer.php?u=/mocks-stubs-andhow-to-use-them/"
    aria-label="Share on Facebook">
    <svg aria-hidden="true" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"
      class="w-5 h-5">
      <title>Facebook</title>
      <path
        d="M379 22v75h-44c-36 0-42 17-42 41v54h84l-12 85h-72v217h-88V277h-72v-85h72v-62c0-72 45-112 109-112 31 0 58 3 65 4z">
      </path>
    </svg>
  </a>
  <a class="border-2 duration-200 ease inline-flex items-center mb-1 mr-1 transition p-2 rounded-full text-white border-slate-600 bg-slate-600 hover:bg-slate-700 hover:border-slate-700"
    target="_blank" rel="noopener"
    href="https://twitter.com/intent/tweet?url=/mocks-stubs-andhow-to-use-them/&text=Mocks, Stubs, and how to use them"
    aria-label="Share on Twitter">
    <svg aria-hidden="true" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"
      class="w-5 h-5">
      <title>Twitter</title>
      <path
        d="m459 152 1 13c0 139-106 299-299 299-59 0-115-17-161-47a217 217 0 0 0 156-44c-47-1-85-31-98-72l19 1c10 0 19-1 28-3-48-10-84-52-84-103v-2c14 8 30 13 47 14A105 105 0 0 1 36 67c51 64 129 106 216 110-2-8-2-16-2-24a105 105 0 0 1 181-72c24-4 47-13 67-25-8 24-25 45-46 58 21-3 41-8 60-17-14 21-32 40-53 55z">
      </path>
    </svg>
  </a>
  <a class="border-2 duration-200 ease inline-flex items-center mb-1 mr-1 transition p-2 rounded-full text-white border-slate-600 bg-slate-600 hover:bg-slate-700 hover:border-slate-700"
    target="_blank" rel="noopener"
    href="https://www.linkedin.com/shareArticle?mini=true&url=/mocks-stubs-andhow-to-use-them/&title=Mocks, Stubs, and how to use them&summary=Mocks, Stubs, and how to use them&source="
    aria-label="Share on Linkedin">
    <svg aria-hidden="true" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"
      class="w-5 h-5">
      <title>Linkedin</title>
      <path
        d="M136 183v283H42V183h94zm6-88c1 27-20 49-53 49-32 0-52-22-52-49 0-28 21-49 53-49s52 21 52 49zm333 208v163h-94V314c0-38-13-64-47-64-26 0-42 18-49 35-2 6-3 14-3 23v158h-94V183h94v41c12-20 34-48 85-48 62 0 108 41 108 127z">
      </path>
    </svg>
  </a>
  <a class="border-2 duration-200 ease inline-flex items-center mb-1 mr-1 transition p-2 rounded-full text-white border-slate-600 bg-slate-600 hover:bg-slate-700 hover:border-slate-700"
    target="_blank" rel="noopener"
    href="https://pinterest.com/pin/create/button/?url=/mocks-stubs-andhow-to-use-them/&media=&description=Mocks, Stubs, and how to use them"
    aria-label="Share on Pinterest" draggable="false">
    <svg aria-hidden="true" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"
      class="w-5 h-5">
      <title>Pinterest</title>
      <path
        d="M268 6C165 6 64 75 64 186c0 70 40 110 64 110 9 0 15-28 15-35 0-10-24-30-24-68 0-81 62-138 141-138 68 0 118 39 118 110 0 53-21 153-90 153-25 0-46-18-46-44 0-38 26-74 26-113 0-67-94-55-94 25 0 17 2 36 10 51-14 60-42 148-42 209 0 19 3 38 4 57 4 3 2 3 7 1 51-69 49-82 72-173 12 24 44 36 69 36 106 0 154-103 154-196C448 71 362 6 268 6z">
      </path>
    </svg>
  </a>
  <a class="border-2 duration-200 ease inline-flex items-center mb-1 mr-1 transition p-2 rounded-full text-white border-slate-600 bg-slate-600 hover:bg-slate-700 hover:border-slate-700"
    target="_blank" rel="noopener"
    href="https://reddit.com/submit/?url=/mocks-stubs-andhow-to-use-them/&resubmit=true&title=Mocks, Stubs, and how to use them"
    aria-label="Share on Reddit" draggable="false">
    <svg aria-hidden="true" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"
      class="w-5 h-5">
      <title>Reddit</title>
      <path
        d="M440 204c-15 0-28 6-38 15-35-24-83-40-137-42l28-125 88 20c0 22 18 39 39 39 22 0 40-18 40-39s-17-40-40-40c-15 0-28 9-35 22l-97-22c-5-1-10 3-11 7l-31 138c-53 2-100 18-136 43a53 53 0 0 0-38-16c-56 0-74 74-23 100l-3 24c0 84 95 152 210 152 117 0 211-68 211-152 0-8-1-17-3-25 50-25 32-99-24-99zM129 309a40 40 0 1 1 80 0 40 40 0 0 1-80 0zm215 93c-37 37-139 37-176 0-4-3-4-9 0-13s10-4 13 0c28 28 120 29 149 0 4-4 10-4 14 0s4 10 0 13zm-1-54c-22 0-39-17-39-39a39 39 0 1 1 39 39z">
      </path>
    </svg>
  </a>
  <a class="border-2 duration-200 ease inline-flex items-center mb-1 mr-1 transition p-2 rounded-full text-white border-slate-600 bg-slate-600 hover:bg-slate-700 hover:border-slate-700"
    target="_blank" rel="noopener"
    href="https://wa.me/?text=Mocks,%20Stubs,%20and%20how%20to%20use%20them%20"
    aria-label="Share on Whatsapp" draggable="false">
    <svg aria-hidden="true" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"
      class="w-5 h-5">
      <title>Whatsapp</title>
      <path
        d="M413 97A222 222 0 0 0 64 365L31 480l118-31a224 224 0 0 0 330-195c0-59-25-115-67-157zM256 439c-33 0-66-9-94-26l-7-4-70 18 19-68-4-7a185 185 0 0 1 287-229c34 36 56 82 55 131 1 102-84 185-186 185zm101-138c-5-3-33-17-38-18-5-2-9-3-12 2l-18 22c-3 4-6 4-12 2-32-17-54-30-75-66-6-10 5-10 16-31 2-4 1-7-1-10l-17-41c-4-10-9-9-12-9h-11c-4 0-9 1-15 7-5 5-19 19-19 46s20 54 23 57c2 4 39 60 94 84 36 15 49 17 67 14 11-2 33-14 37-27s5-24 4-26c-2-2-5-4-11-6z">
      </path>
    </svg>
  </a>
  <a class="border-2 duration-200 ease inline-flex items-center mb-1 mr-1 transition p-2 rounded-full text-white border-slate-600 bg-slate-600 hover:bg-slate-700 hover:border-slate-700"
    target="_blank" rel="noopener"
    href="https://telegram.me/share/url?text=Mocks,%20Stubs,%20and%20how%20to%20use%20them&url=/mocks-stubs-andhow-to-use-them/"
    aria-label="Share on Telegram" draggable="false">
    <svg aria-hidden="true" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"
      class="w-5 h-5">
      <title>Telegram</title>
      <path
        d="M256 8a248 248 0 1 0 0 496 248 248 0 0 0 0-496zm115 169c-4 39-20 134-28 178-4 19-10 25-17 25-14 2-25-9-39-18l-56-37c-24-17-8-25 6-40 3-4 67-61 68-67l-1-4-5-1q-4 1-105 70-15 10-27 9c-9 0-26-5-38-9-16-5-28-7-27-16q1-7 18-14l145-62c69-29 83-34 92-34 2 0 7 1 10 3l4 7a43 43 0 0 1 0 10z">
      </path>
    </svg>
  </a>
  <a class="border-2 duration-200 ease inline-flex items-center mb-1 mr-1 transition p-2 rounded-full text-white border-slate-600 bg-slate-600 hover:bg-slate-700 hover:border-slate-700"
    target="_blank" rel="noopener"
    href="mailto:?subject=Mocks,%20Stubs,%20and%20how%20to%20use%20them&body=/mocks-stubs-andhow-to-use-them/"
    aria-label="Share by Email" draggable="false">
    <svg aria-hidden="true" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"
      class="w-5 h-5">
      <title>Email</title>
      <path
        d="M464 64a48 48 0 0 1 29 86L275 314c-11 8-27 8-38 0L19 150a48 48 0 0 1 29-86h416zM218 339c22 17 54 17 76 0l218-163v208c0 35-29 64-64 64H64c-35 0-64-29-64-64V176l218 163z">
      </path>
    </svg>
  </a>
</div>

    </div>

    <div class="font-mulish flex justify-center mb-10">
      
      <a class="pr-2" href="/dry-unit-tests-are-bad/">&laquo; DRY unit tests are bad... mkay</a>
      
      
      <a class="pl-2" href="/unit-test-the-brains-and-not-the-nerves/">Unit test the brains and not the nerves &raquo;</a>
      
    </div>

    
  </div>
</div>
 

<footer class="w-full bottom-0">
  <hr class="my-8 border-zinc-200" />
  <div class="container mx-auto">
    <div class="flex flex-wrap text-left">
      <div class="w-full md:w-6/12 md:px-4">
        <p class="text-3xl font-semibold">
          Let's keep in touch!
        </p>
        <p class="font-mulish text-lg dark:text-zinc-300 mt-2 mb-2">
           Find me on any of these platforms. 
        </p>
         <div class="flex justify-center md:justify-start pt-2 gap-6">
   
  <a
    class="transition hover:scale-110 duration-300"
    href="mailto:srikanth@sastry.name"
  >
    <img
      class="h-6 w-6"
      src="/assets/images/contact_channels/email.svg"
      alt="Email Icon"
    />
  </a>
   
  <a
    class="transition hover:scale-110 duration-300"
    href="https://github.com/srikanthsastry"
    target="_blank"
  >
    <img
      class="h-6 w-6"
      src="/assets/images/contact_channels/github-mark.svg"
      alt="Github Icon"
    />
  </a>
      
  
  <a
    class="transition hover:scale-110 duration-300"
    href="https://www.linkedin.com/in/srikanthsastry/"
    target="_blank"
  >
    <img
      class="h-6 w-6"
      src="/assets/images/contact_channels/linkedin.svg"
      alt="LinkedIn Icon"
    />  
  </a>
   
  <a
    class="transition hover:scale-110 duration-300"
    href="https://www.threads.com/@sri.sastry"
    target="_blank"
  >
    <img
      class="h-6 w-6"
      src="/assets/images/contact_channels/threads.svg"
      alt="Threads Icon"
    />
  </a>
  
</div>
 
      </div>
      <div class="w-full md:w-6/12 md:text-right py-4 md:py-0">
        <div class="flex flex-wrap items-top mb-6">
          <div class="w-full lg:w-4/12 md:px-4 ml-auto">
            <span class="text-lg block text-gray-800 mb-2">
              Pages
            </span>
            <ul>
                 
              <li>
                <a class="font-mulish text-slate-600 hover:text-sky-400 dark:text-slate-300 dark:hover:text-slate-200"
                  href="/archives/">Archives</a>
              </li>
                
              <li>
                <a class="font-mulish text-slate-600 hover:text-sky-400 dark:text-slate-300 dark:hover:text-slate-200"
                  href="/">Home</a>
              </li>
                
              <li>
                <a class="font-mulish text-slate-600 hover:text-sky-400 dark:text-slate-300 dark:hover:text-slate-200"
                  href="/publications/">Publications</a>
              </li>
                
              <li>
                <a class="font-mulish text-slate-600 hover:text-sky-400 dark:text-slate-300 dark:hover:text-slate-200"
                  href="/touchstone-radio-episodes/">Touchstone Radio Episodes</a>
              </li>
                           
            </ul>
          </div>
        </div>
      </div>
    </div>
    <div class="font-mulish flex flex-wrap items-center md:justify-between justify-center my-8">
      <div class="w-full md:w-4/12 px-4 mx-auto text-center">
        
        <a href="/feed.xml" class="p-2">
          <svg fill="#000000" viewBox="-3 0 19 19" xmlns="http://www.w3.org/2000/svg" class="w-10 mx-auto">
            <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
            <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
            <g id="SVGRepo_iconCarrier">
              <path
                d="M.926 12.818a1.403 1.403 0 1 1 0 1.984 1.402 1.402 0 0 1 0-1.984zm10.531 2.357a1.03 1.03 0 0 1-1.029-1.03 8.775 8.775 0 0 0-.694-3.438A8.826 8.826 0 0 0 1.591 5.31a1.03 1.03 0 1 1 0-2.059 10.817 10.817 0 0 1 4.24.857 10.893 10.893 0 0 1 3.463 2.334 10.867 10.867 0 0 1 3.19 7.703 1.027 1.027 0 0 1-1.027 1.029zm-4.538 0a1.03 1.03 0 0 1-1.029-1.03 4.297 4.297 0 0 0-4.299-4.298 1.03 1.03 0 0 1 0-2.059 6.362 6.362 0 0 1 5.857 3.883 6.298 6.298 0 0 1 .5 2.475 1.03 1.03 0 0 1-1.029 1.029z">
              </path>
            </g>
          </svg>
        </a>
        
        <div class="text-sm text-blueGray-500 font-semibold py-1">
          © <span id="get-current-year">2025</span>
          <a href="https://www.creative-tim.com/product/notus-js" class="text-blueGray-500 hover:text-gray-800"
            target="_blank" aria-label="Creative C">Srikanth Sastry.</a>
          All rights reserved.
          <p class="text-xs pt-4">
            Built with ❤️ using the
            <a class="hover:text-sky-400" href="https://github.com/a-chacon/awesome-jekyll-theme">Awesome Jekyll
              Theme</a>.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

  <script>
    document.querySelectorAll("a").forEach(function (link) {
      link.addEventListener("click", function (event) {
        event.preventDefault(); // Prevent the default link action temporarily
        link.classList.add("gentle-clicked");

        setTimeout(function () {
          link.classList.remove("gentle-clicked");
          window.location.href = link.href; // Navigate to the link after the animation
        }, 300); // Duration of the gentle bounce animation
      });
    });
  </script>
</body>

</html>
